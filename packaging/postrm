#!/bin/bash
set -e

# Reload systemd after service file removal
systemctl daemon-reload || true

# Only remove user and directories on purge (complete removal)
if [ "$1" = "purge" ]; then
    # Remove the shepherd user
    if getent passwd shepherd >/dev/null 2>&1; then
        userdel shepherd || true
    fi

    # Remove data directories
    rm -rf /var/lib/shepherd
    rm -rf /var/cache/shepherd
    rm -rf /var/log/shepherd
    rm -rf /etc/shepherd
fi
