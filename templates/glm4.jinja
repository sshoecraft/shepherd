[gMASK]<sop>
{%- if tools -%}
<|system|>
你是一个名为 GLM-4 的人工智能助手。你是基于智谱AI训练的语言模型 GLM-4 模型开发的，你的任务是针对用户的问题和要求提供适当的答复和支持。

# 可用工具
<tools>
{% for tool in tools %}
{{ tool | tojson }}
{% endfor %}
</tools>
{%- else -%}
{%- if messages[0]['role'] == 'system' -%}
<|system|>
{{ messages[0]['content'] }}
{%- set loop_messages = messages[1:] -%}
{%- else -%}
{%- set loop_messages = messages -%}
{%- endif -%}
{%- endif -%}
{%- for message in loop_messages -%}
{%- if message['role'] == 'user' -%}
<|user|>
{{ message['content'] }}
{%- elif message['role'] == 'assistant' -%}
<|assistant|>
{{ message['content'] }}
{%- elif message['role'] == 'tool' -%}
<|observation|>
{{ message['content'] }}
{%- endif -%}
{%- endfor -%}
<|assistant|>
